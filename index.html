<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Dashboard Ambiental IoT</title>

<style>
:root{
  --bg:#f4f6f8;
  --card:#ffffff;
  --primary:#1b4332;
  --accent:#2d6a4f;
  --soft:#40916c;
  --muted:#6c757d;
  --danger:#d62828;
  --warning:#f77f00;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:"Inter","Segoe UI",sans-serif;
  background:var(--bg);
  color:#212529;
}

header{
  padding:1.2rem;
  background:linear-gradient(135deg,var(--primary),var(--accent));
  color:white;
  text-align:center;
}

header h1{
  margin:0;
  font-size:1.8rem;
}

header p{
  margin:.3rem 0 0;
  opacity:.85;
}

main{
  max-width:1100px;
  margin:auto;
  padding:1.2rem;
}

.section{
  margin-bottom:1.5rem;
}

.section h2{
  margin:.2rem 0 .8rem;
  color:var(--primary);
  font-size:1.2rem;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
  gap:1rem;
}

.card{
  background:var(--card);
  border-radius:18px;
  padding:1.1rem;
  box-shadow:0 6px 20px rgba(0,0,0,.08);
  text-align:center;
}

.card .label{
  font-size:.9rem;
  color:var(--muted);
}

.card .value{
  font-size:2.4rem;
  font-weight:700;
  color:var(--accent);
  margin:.3rem 0;
}

.card .unit{
  font-size:.85rem;
  color:#777;
}

.status{
  font-size:.85rem;
  margin-top:.4rem;
}

footer{
  text-align:center;
  padding:1rem;
  font-size:.8rem;
  color:#666;
}
</style>
</head>

<body>

<header>
  <h1>üåé Dashboard Ambiental IoT</h1>
  <p>Monitoreo en tiempo real ¬∑ ESP32 ¬∑ Blynk Cloud</p>
</header>

<main>

  <!-- AMBIENTE -->
  <section class="section">
    <h2>üå° Ambiente</h2>
    <div class="grid">
      <div class="card">
        <div class="label">Temperatura Ambiente</div>
        <div id="t1" class="value">--</div>
        <div class="unit">¬∞C (DHT21)</div>
      </div>
      <div class="card">
        <div class="label">Humedad Ambiente</div>
        <div id="h1" class="value">--</div>
        <div class="unit">% (DHT21)</div>
      </div>
      <div class="card">
        <div class="label">Temperatura Precisi√≥n</div>
        <div id="t2" class="value">--</div>
        <div class="unit">¬∞C (SCD30)</div>
      </div>
      <div class="card">
        <div class="label">Humedad Precisi√≥n</div>
        <div id="h2" class="value">--</div>
        <div class="unit">% (SCD30)</div>
      </div>
    </div>
  </section>

  <!-- CALIDAD AIRE -->
  <section class="section">
    <h2>ü´Å Calidad del Aire</h2>
    <div class="grid">
      <div class="card">
        <div class="label">CO‚ÇÇ</div>
        <div id="co2" class="value">--</div>
        <div class="unit">ppm</div>
      </div>
      <div class="card">
        <div class="label">TVOC</div>
        <div id="tvoc" class="value">--</div>
        <div class="unit">ppb</div>
      </div>
    </div>
  </section>

  <!-- LUZ -->
  <section class="section">
    <h2>‚òÄ Radiaci√≥n y Luz</h2>
    <div class="grid">
      <div class="card">
        <div class="label">Iluminancia</div>
        <div id="lux" class="value">--</div>
        <div class="unit">Lux</div>
      </div>
      <div class="card">
        <div class="label">Luz Visible</div>
        <div id="visible" class="value">--</div>
        <div class="unit">Raw</div>
      </div>
      <div class="card">
        <div class="label">Infrarrojo</div>
        <div id="ir" class="value">--</div>
        <div class="unit">Raw</div>
      </div>
      <div class="card">
        <div class="label">√çndice UV</div>
        <div id="uv" class="value">--</div>
        <div class="unit">UV Index</div>
      </div>
    </div>
  </section>

</main>

<footer>
  ¬© 2025 ¬∑ Sistema Ambiental IoT ¬∑ ESP32 + Blynk + Google Sheets
</footer>

<script>
/* ================= CONFIG ================= */
const TOKEN="BY-BXxFYfcg233KYZkGoGlTYOevtPr6N";
const API="https://blynk.cloud/external/api/get";
const REFRESH=1000;

const PINS={
  t1:"V4",
  h1:"V5",
  t2:"V6",
  h2:"V7",
  co2:"V8",
  tvoc:"V9",
  lux:"V0",
  visible:"V1",
  ir:"V2",
  uv:"V3"
};

/* ================= LOGIC ================= */
async function getPin(pin){
  try{
    const r=await fetch(`${API}?token=${TOKEN}&${pin}`,{cache:"no-store"});
    if(!r.ok) throw new Error();
    return (await r.text()).trim();
  }catch{return "--";}
}

async function update(){
  for(const id in PINS){
    const val=await getPin(PINS[id]);
    const el=document.getElementById(id);
    if(el && val!=="--"){
      el.textContent=parseFloat(val).toFixed(1);
    }
  }
}

setInterval(update,REFRESH);
update();
</script>

</body>
</html>
